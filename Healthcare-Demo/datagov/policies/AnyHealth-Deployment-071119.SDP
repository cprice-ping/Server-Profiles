[{"class":"Package","id":"98afab4e-5033-4fe0-a72d-8640787770d4","name":"AnyHealth - 7/11/19","deploymentPackageVersion":1,"applicationName":"Symphonic deployment-package-create","applicationVersion":"8.1.1","dateCreated":"2019-07-12T02:30:22.286969Z","createdBy":"admin","snapshotId":"be74669a-762d-4d0f-a385-003cea24cb61","snapshotMessage":"Initial Commit of GA Policies","snapshotDateCommitted":"2019-07-01T15:52:34.322945Z","decisionNodeId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","decisionNodeName":"Global Decision Point"},{"class":"AttributeDefinition","id":"a007b39b-33ca-436c-977f-21a4831daa96","name":"HttpRequest","resolvers":[{"class":"request","condition":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"8e568465-2e7c-4705-8d94-53102ea8550f","name":"HttpRequest.AccessToken","resolvers":[{"class":"attribute","attributeDefinitionId":"a007b39b-33ca-436c-977f-21a4831daa96","condition":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"AccessToken"}]}},"properties":{}},{"class":"AttributeDefinition","id":"9d722951-77a8-4ae6-94f9-6ced4adfee17","name":"HttpRequest.AccessToken.active","resolvers":[{"class":"attribute","attributeDefinitionId":"8e568465-2e7c-4705-8d94-53102ea8550f","condition":null}],"defaultValue":"false","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"BOOLEAN","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$.active"}]}},"properties":{}},{"class":"AttributeNode","id":"c621277e-fe5c-3ba8-8a0c-01dac32c0db9","attributeDefinitionId":"9d722951-77a8-4ae6-94f9-6ced4adfee17"},{"class":"ConstantNode","id":"68934a3e-9455-3a72-8202-37eb05902327","constant":"false"},{"class":"ComparisonNode","id":"f3943231-6339-3580-83ba-05fe7638b4ff","lhsInputNode":"c621277e-fe5c-3ba8-8a0c-01dac32c0db9","rhsInputNode":"68934a3e-9455-3a72-8202-37eb05902327","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"08519ba4-db77-3b31-99d7-5d50671b3388","inputNodes":["f3943231-6339-3580-83ba-05fe7638b4ff"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"f9604cb4-315d-47eb-9e76-4d8c7534bb41","name":"Access token is inactive","properties":{},"disabled":false},{"class":"DecisionNode","id":"68b353e2-e328-3aa8-b7ee-fb1cb59350ea","metadataId":"f9604cb4-315d-47eb-9e76-4d8c7534bb41","effect":"DENY","inputNode":"08519ba4-db77-3b31-99d7-5d50671b3388"},{"class":"StatementNode","id":"361c16b0-81c4-37c8-9b6e-5f9ec2cd8d1d","inputNode":"68b353e2-e328-3aa8-b7ee-fb1cb59350ea","metadataId":"f9604cb4-315d-47eb-9e76-4d8c7534bb41","statements":[]},{"class":"TargetMatchNode","id":"15eefcd8-744e-36e4-8d43-7252c825594b","inputNode":"361c16b0-81c4-37c8-9b6e-5f9ec2cd8d1d","metadataId":"f9604cb4-315d-47eb-9e76-4d8c7534bb41","targets":[]},{"class":"Metadata","originType":"Policy","originId":"69d82f74-5561-4f91-b238-0f8bbac97532","name":"Token Validation","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"5509975b-da5d-38a3-812a-2414a37fc75f","combiningAlgorithm":{"name":"PermitUnlessDeny"},"inputNodes":["15eefcd8-744e-36e4-8d43-7252c825594b"],"inputNodeWeights":[100],"guardNode":null,"originLink":"69d82f74-5561-4f91-b238-0f8bbac97532"},{"class":"StatementTemplate","id":"cde26a38-2035-4385-bbfe-159ee1822976","name":"Invalid Token","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"denied-reason"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"{\"status\":401, \"message\": \"invalid_token\", \"detail\":\"Access token is expired or otherwise invalid\"}"}]},"obligatory":true,"appliesTo":"DENY","attributes":{},"services":{}},{"class":"StatementNode","id":"c99b03a0-869a-3d87-a38a-195de8e96d98","inputNode":"5509975b-da5d-38a3-812a-2414a37fc75f","metadataId":"69d82f74-5561-4f91-b238-0f8bbac97532","statements":["cde26a38-2035-4385-bbfe-159ee1822976"]},{"class":"TargetMatchNode","id":"f4c9d0c8-e1fd-33d0-a163-885e7f5cb7fb","inputNode":"c99b03a0-869a-3d87-a38a-195de8e96d98","metadataId":"69d82f74-5561-4f91-b238-0f8bbac97532","targets":[]},{"class":"AttributeDefinition","id":"82a8b53f-196e-481a-a26b-4d59f8d0aff8","name":"recordOwner.Lookup-User","resolvers":[],"defaultValue":"cn=administrator","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"STRING"},"properties":{}},{"class":"AttributeDefinition","id":"85f03c1d-be87-4904-992d-e3511222200a","name":"recordOwner.Lookup-Password","resolvers":[],"defaultValue":"2FederateM0re","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":true,"expression":{"type":"coerce","valueType":"STRING"},"properties":{}},{"class":"AttributeDefinition","id":"2139c312-6f7d-49ff-8d00-c48231ed8f19","name":"HttpRequest.ResponseBody","resolvers":[{"class":"attribute","attributeDefinitionId":"a007b39b-33ca-436c-977f-21a4831daa96","condition":null}],"defaultValue":"{}","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"ResponseBody"}]}},"properties":{}},{"class":"AlwaysTrueNode","id":"6b0617b1-260a-362a-b56a-09d987f60632"},{"class":"AttributeDefinition","id":"2acd31d2-77b5-4a8a-963d-4d1ceb23c45b","name":"FHIR - Record","resolvers":[{"class":"attribute","attributeDefinitionId":"2139c312-6f7d-49ff-8d00-c48231ed8f19","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"daef2dd8-8384-4574-8034-9c53a61707ca","name":"FHIR - Record.id","resolvers":[{"class":"attribute","attributeDefinitionId":"2acd31d2-77b5-4a8a-963d-4d1ceb23c45b","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":"Empty (id)","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"COLLECTION","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$..id"}]}},"properties":{}},{"class":"AttributeDefinition","id":"0356fb4c-50bd-41c8-835d-f0e6d1bb2e82","name":"FHIR - Record.id.parsedValue","resolvers":[{"class":"attribute","attributeDefinitionId":"daef2dd8-8384-4574-8034-9c53a61707ca","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$[0]"}]}},"properties":{}},{"class":"ServiceDefinition","id":"7c1a50e1-9669-448c-abd5-61901f03debd","name":"recordOwner - PD User Lookup","serviceSettings":{"class":"rest","urlFormat":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"https://int-docker.anyhealth-demo.ping-eng.com:1443/directory/v1/ou=people,o=acmehealth.org/subtree?searchScope=wholeSubtree&filter=fhirIdentifier.value eq \""},{"@class":"Interpolation","hole":"0356fb4c-50bd-41c8-835d-f0e6d1bb2e82","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\""}]},"body":{"@class":"JoiningTemplate","components":[]},"verb":"GET","contentType":"application/json","headers":[],"authenticationType":"BASIC","authenticationAttributes":{"@class":"MapTemplate","map":{"name":{"@class":"Interpolation","hole":"82a8b53f-196e-481a-a26b-4d59f8d0aff8","safelyInterpolatable":false},"password":{"@class":"Interpolation","hole":"85f03c1d-be87-4904-992d-e3511222200a","safelyInterpolatable":false}}}},"expression":{"type":"coerce","valueType":"JSON"},"properties":{},"serviceResilience":{"maximumConcurrentRequests":2,"maximumRequestsPerSecond":1000000.0,"timeoutMilliseconds":2000,"maximumRetryCount":2,"holdoffMilliseconds":1000,"retryStrategy":"FIXED","retryJitter":10.0},"secret":false},{"class":"AttributeDefinition","id":"c1725d9a-b154-4cf4-9261-079eaa4fd574","name":"recordOwner","resolvers":[{"class":"service","condition":"6b0617b1-260a-362a-b56a-09d987f60632","serviceDefinitionId":"7c1a50e1-9669-448c-abd5-61901f03debd"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":true,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"15b126ff-11c3-4a08-8aa0-19994f9d4f8e","name":"recordOwner.fhirRelatedPerson","resolvers":[{"class":"attribute","attributeDefinitionId":"c1725d9a-b154-4cf4-9261-079eaa4fd574","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$._embedded.entries[0].fhirRelatedPerson[0].identifier"}]}},"properties":{}},{"class":"AttributeNode","id":"d879cd81-38de-3e0c-b57d-74c76eebbbff","attributeDefinitionId":"15b126ff-11c3-4a08-8aa0-19994f9d4f8e"},{"class":"AttributeDefinition","id":"ee41314a-eb03-4a6e-9561-82ff8dd13865","name":"HttpRequest.AccessToken.subject","resolvers":[{"class":"attribute","attributeDefinitionId":"8e568465-2e7c-4705-8d94-53102ea8550f","condition":null}],"defaultValue":"_null","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"sub"}]}},"properties":{}},{"class":"ServiceDefinition","id":"5364c711-a750-4015-a1e7-6575c44dcd58","name":"tokenOwner - PD User Lookup","serviceSettings":{"class":"rest","urlFormat":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"https://int-docker.anyhealth-demo.ping-eng.com:1443/directory/v1/ou=people,o=acmehealth.org/subtree?searchScope=wholeSubtree&filter=entryUUID eq \""},{"@class":"Interpolation","hole":"ee41314a-eb03-4a6e-9561-82ff8dd13865","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\""}]},"body":{"@class":"JoiningTemplate","components":[]},"verb":"GET","contentType":"application/json","headers":[],"authenticationType":"BASIC","authenticationAttributes":{"@class":"MapTemplate","map":{"name":{"@class":"Interpolation","hole":"82a8b53f-196e-481a-a26b-4d59f8d0aff8","safelyInterpolatable":false},"password":{"@class":"Interpolation","hole":"85f03c1d-be87-4904-992d-e3511222200a","safelyInterpolatable":false}}}},"expression":{"type":"coerce","valueType":"JSON"},"properties":{},"serviceResilience":{"maximumConcurrentRequests":2,"maximumRequestsPerSecond":1000000.0,"timeoutMilliseconds":2000,"maximumRetryCount":2,"holdoffMilliseconds":1000,"retryStrategy":"FIXED","retryJitter":10.0},"secret":false},{"class":"AttributeDefinition","id":"c3852040-8812-48c5-b5ae-e9ca5486f093","name":"tokenOwner.entryUUID","resolvers":[{"class":"service","condition":"6b0617b1-260a-362a-b56a-09d987f60632","serviceDefinitionId":"5364c711-a750-4015-a1e7-6575c44dcd58"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$._embedded.entries[0].entryUUID"}]}},"properties":{}},{"class":"AttributeNode","id":"ae5c83de-c9f5-3ad0-8715-7eb581e730c7","attributeDefinitionId":"c3852040-8812-48c5-b5ae-e9ca5486f093"},{"class":"ComparisonNode","id":"da5ba72a-151c-3f1e-94e9-e3524a127399","lhsInputNode":"d879cd81-38de-3e0c-b57d-74c76eebbbff","rhsInputNode":"ae5c83de-c9f5-3ad0-8715-7eb581e730c7","operator":"CONTAINS"},{"class":"BooleanLogicNode","id":"34afd4b7-6dd7-31fe-a580-a9d23734ddb0","inputNodes":["da5ba72a-151c-3f1e-94e9-e3524a127399"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"64d6b710-751a-436e-a1ab-400aae7f5146","name":"Spouses don't see all objects","properties":{},"disabled":false},{"class":"DecisionNode","id":"184bc83e-f168-378f-9adf-ef144fb37cda","metadataId":"64d6b710-751a-436e-a1ab-400aae7f5146","effect":"PERMIT","inputNode":"34afd4b7-6dd7-31fe-a580-a9d23734ddb0"},{"class":"StatementTemplate","id":"3c9042f4-f8af-438d-bba8-8d1cf577ab84","name":"Remove  values","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"exclude-attributes"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"[ \"$..coding\", \"$.identifier\", \"$.extension\", \"$.communication\" ]"}]},"obligatory":false,"appliesTo":"PERMIT","attributes":{},"services":{}},{"class":"StatementNode","id":"3159f66f-69f5-3541-9491-90c682f1aaf0","inputNode":"184bc83e-f168-378f-9adf-ef144fb37cda","metadataId":"64d6b710-751a-436e-a1ab-400aae7f5146","statements":["3c9042f4-f8af-438d-bba8-8d1cf577ab84"]},{"class":"TargetMatchNode","id":"bb03cf77-4a48-34a6-86e2-991ed27e0807","inputNode":"3159f66f-69f5-3541-9491-90c682f1aaf0","metadataId":"64d6b710-751a-436e-a1ab-400aae7f5146","targets":[]},{"class":"AttributeDefinition","id":"3577dd53-a71a-4ce8-ab40-c9c083c7c5b9","name":"tokenOwner","resolvers":[{"class":"service","condition":"6b0617b1-260a-362a-b56a-09d987f60632","serviceDefinitionId":"5364c711-a750-4015-a1e7-6575c44dcd58"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"5c58cf4e-3f72-4881-86b3-00de19897192","name":"tokenOwner.objectClass","resolvers":[{"class":"attribute","attributeDefinitionId":"3577dd53-a71a-4ce8-ab40-c9c083c7c5b9","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"COLLECTION","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$._embedded.entries[0].objectClass"}]}},"properties":{}},{"class":"AttributeNode","id":"0ffc0b30-f1ba-378a-bbf4-3d54be941367","attributeDefinitionId":"5c58cf4e-3f72-4881-86b3-00de19897192"},{"class":"ConstantNode","id":"2fcc4c5f-37d6-3238-bab7-5d2edb84ab90","constant":"fhirPractitioner"},{"class":"ComparisonNode","id":"aaf1620e-4454-3229-838e-20504da64955","lhsInputNode":"0ffc0b30-f1ba-378a-bbf4-3d54be941367","rhsInputNode":"2fcc4c5f-37d6-3238-bab7-5d2edb84ab90","operator":"CONTAINS"},{"class":"AttributeDefinition","id":"e65a72ed-9de2-4396-a2f7-2d51cd457005","name":"FHIR - Record.resourceType","resolvers":[{"class":"attribute","attributeDefinitionId":"2acd31d2-77b5-4a8a-963d-4d1ceb23c45b","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"resourceType"}]}},"properties":{}},{"class":"AttributeNode","id":"07031b38-c3ed-363f-a5d2-34dd83f70931","attributeDefinitionId":"e65a72ed-9de2-4396-a2f7-2d51cd457005"},{"class":"ConstantNode","id":"01122a97-dca9-3721-8827-560cb7d76af8","constant":"Patient"},{"class":"ComparisonNode","id":"739238e8-1d83-37ce-ae9f-5e9c5d9d9316","lhsInputNode":"07031b38-c3ed-363f-a5d2-34dd83f70931","rhsInputNode":"01122a97-dca9-3721-8827-560cb7d76af8","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"0cd3e8e2-1cf4-3363-aef8-c98760c10073","inputNodes":["aaf1620e-4454-3229-838e-20504da64955","739238e8-1d83-37ce-ae9f-5e9c5d9d9316"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"1af8415a-7ab9-46c7-928e-a1b137e8fd5e","name":"Practitioner see some things","properties":{},"disabled":false},{"class":"DecisionNode","id":"955bbb5e-da9d-353d-bc9e-f2b2d411812e","metadataId":"1af8415a-7ab9-46c7-928e-a1b137e8fd5e","effect":"PERMIT","inputNode":"0cd3e8e2-1cf4-3363-aef8-c98760c10073"},{"class":"StatementTemplate","id":"519c9d61-7957-45c4-b4df-79683e39890c","name":"What a Practitioner can see","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"include-attributes"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"[ \"$.birthdate\", \"$.gender\", \"$.careProvider\", \"$.name\" ]"}]},"obligatory":false,"appliesTo":"ANYTHING","attributes":{},"services":{}},{"class":"StatementNode","id":"836db63b-3518-3217-a73d-98a463316ae2","inputNode":"955bbb5e-da9d-353d-bc9e-f2b2d411812e","metadataId":"1af8415a-7ab9-46c7-928e-a1b137e8fd5e","statements":["519c9d61-7957-45c4-b4df-79683e39890c"]},{"class":"TargetMatchNode","id":"c92d66d9-ceec-3cca-be9c-3a739851dd17","inputNode":"836db63b-3518-3217-a73d-98a463316ae2","metadataId":"1af8415a-7ab9-46c7-928e-a1b137e8fd5e","targets":[]},{"class":"Metadata","originType":"Policy","originId":"fa89a233-d223-44e5-9a2f-36855ccf4cb1","name":"Manipulate Responses","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"64bc83cb-7836-32df-9891-ccf9c2442141","combiningAlgorithm":{"name":"PermitUnlessDeny"},"inputNodes":["bb03cf77-4a48-34a6-86e2-991ed27e0807","c92d66d9-ceec-3cca-be9c-3a739851dd17"],"inputNodeWeights":[100,100],"guardNode":null,"originLink":"fa89a233-d223-44e5-9a2f-36855ccf4cb1"},{"class":"StatementNode","id":"910f7414-0bb5-39cf-a4df-2930b9702a87","inputNode":"64bc83cb-7836-32df-9891-ccf9c2442141","metadataId":"fa89a233-d223-44e5-9a2f-36855ccf4cb1","statements":[]},{"class":"TargetMatchNode","id":"64d2e3a6-b1bf-3d0f-a66e-fbec5938f228","inputNode":"910f7414-0bb5-39cf-a4df-2930b9702a87","metadataId":"fa89a233-d223-44e5-9a2f-36855ccf4cb1","targets":[]},{"class":"AttributeDefinition","id":"8a05a350-abdd-407f-8dcb-27234ddb6261","name":"tokenOwner.fhirIdentifier","resolvers":[{"class":"attribute","attributeDefinitionId":"3577dd53-a71a-4ce8-ab40-c9c083c7c5b9","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$..fhirIdentifier"}]}},"properties":{}},{"class":"AttributeDefinition","id":"906145d2-15d2-43b5-968a-375d13d907d2","name":"HttpRequest.AccessToken.audience","resolvers":[{"class":"attribute","attributeDefinitionId":"8e568465-2e7c-4705-8d94-53102ea8550f","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":"[]","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"aud[0]"}]}},"properties":{}},{"class":"AttributeDefinition","id":"a16e2fef-1eef-41d2-9722-8d975b9c7fe4","name":"tokenOwner.fhirIdentifier.value","resolvers":[{"class":"attribute","attributeDefinitionId":"8a05a350-abdd-407f-8dcb-27234ddb6261","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":"Empty (fhirIdentifier)","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"COLLECTION","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$..[?(@.type == \""},{"@class":"Interpolation","hole":"906145d2-15d2-43b5-968a-375d13d907d2","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\")].value"}]}},"properties":{}},{"class":"AttributeNode","id":"e1ad2d40-decf-3b63-9610-c9a1b3063533","attributeDefinitionId":"a16e2fef-1eef-41d2-9722-8d975b9c7fe4"},{"class":"AttributeNode","id":"11ba109e-f4e9-3a31-b117-fdec859bc336","attributeDefinitionId":"0356fb4c-50bd-41c8-835d-f0e6d1bb2e82"},{"class":"ComparisonNode","id":"b783a4ad-0216-3442-9149-56c290a0c6ea","lhsInputNode":"e1ad2d40-decf-3b63-9610-c9a1b3063533","rhsInputNode":"11ba109e-f4e9-3a31-b117-fdec859bc336","operator":"CONTAINS"},{"class":"BooleanLogicNode","id":"63ba528d-dc4f-3b87-97b0-43262f073fce","inputNodes":["b783a4ad-0216-3442-9149-56c290a0c6ea"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"d3ef17f4-23ce-4c45-9b8b-39e64d9f80ce","name":"Patient can always see Patient data","properties":{},"disabled":false},{"class":"DecisionNode","id":"31d27e4d-8a31-39c5-8302-3f33f655e6fb","metadataId":"d3ef17f4-23ce-4c45-9b8b-39e64d9f80ce","effect":"PERMIT","inputNode":"63ba528d-dc4f-3b87-97b0-43262f073fce"},{"class":"StatementNode","id":"2553e510-68e8-3785-b100-8434c8405644","inputNode":"31d27e4d-8a31-39c5-8302-3f33f655e6fb","metadataId":"d3ef17f4-23ce-4c45-9b8b-39e64d9f80ce","statements":[]},{"class":"TargetMatchNode","id":"6d4b6dd0-f69e-3275-802b-abe0daa70103","inputNode":"2553e510-68e8-3785-b100-8434c8405644","metadataId":"d3ef17f4-23ce-4c45-9b8b-39e64d9f80ce","targets":[]},{"class":"AttributeDefinition","id":"98722606-43cf-4fca-8d8d-a061bc6a6c11","name":"Consent Record - EMR-Access.Lookup - User","resolvers":[],"defaultValue":"cn=administrator","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"STRING"},"properties":{}},{"class":"AttributeDefinition","id":"18fbb93b-baaf-48a6-af76-ebdf632a4dac","name":"Consent Record - EMR-Access.Lookup - Password","resolvers":[],"defaultValue":"2FederateM0re","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":true,"expression":{"type":"coerce","valueType":"STRING"},"properties":{}},{"class":"AttributeDefinition","id":"23929c0c-a2d2-494a-9642-e26661b2f835","name":"recordOwner.entryUUID","resolvers":[{"class":"attribute","attributeDefinitionId":"c1725d9a-b154-4cf4-9261-079eaa4fd574","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$._embedded.entries[0].entryUUID"}]}},"properties":{}},{"class":"ServiceDefinition","id":"e31e9691-0ded-44c8-ad40-600274df0703","name":"ConsentAPI - EMR-Access","serviceSettings":{"class":"rest","urlFormat":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"https://int-docker.anyhealth-demo.ping-eng.com:1443/consent/v1/consents?definition=EMR-Access&subject="},{"@class":"Interpolation","hole":"23929c0c-a2d2-494a-9642-e26661b2f835","safelyInterpolatable":false}]},"body":{"@class":"JoiningTemplate","components":[]},"verb":"GET","contentType":"application/json","headers":[],"authenticationType":"BASIC","authenticationAttributes":{"@class":"MapTemplate","map":{"name":{"@class":"Interpolation","hole":"98722606-43cf-4fca-8d8d-a061bc6a6c11","safelyInterpolatable":false},"password":{"@class":"Interpolation","hole":"18fbb93b-baaf-48a6-af76-ebdf632a4dac","safelyInterpolatable":false}}}},"expression":{"type":"jsonPath","valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$..consents[-1]"}]}},"properties":{},"serviceResilience":{"maximumConcurrentRequests":2,"maximumRequestsPerSecond":1000000.0,"timeoutMilliseconds":2000,"maximumRetryCount":2,"holdoffMilliseconds":1000,"retryStrategy":"FIXED","retryJitter":10.0},"secret":false},{"class":"AttributeDefinition","id":"e311c28a-3cb0-47ba-850f-4905cbfc1c02","name":"Consent Record - EMR-Access","resolvers":[{"class":"service","condition":"6b0617b1-260a-362a-b56a-09d987f60632","serviceDefinitionId":"e31e9691-0ded-44c8-ad40-600274df0703"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"95f1d997-65e5-4a64-9941-0ce81a387a34","name":"Consent Record - EMR-Access.implicitIdentifiers","resolvers":[{"class":"attribute","attributeDefinitionId":"e311c28a-3cb0-47ba-850f-4905cbfc1c02","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":"[ \"NoIdentifier\" ]","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"COLLECTION","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$..data.implicit[?(@.provider == \""},{"@class":"Interpolation","hole":"906145d2-15d2-43b5-968a-375d13d907d2","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\")].identifier"}]}},"properties":{}},{"class":"AttributeNode","id":"58485bc8-43f2-30b8-8271-deb42ad81021","attributeDefinitionId":"95f1d997-65e5-4a64-9941-0ce81a387a34"},{"class":"ComparisonNode","id":"4a5b89e0-42b1-322f-b90d-3c32a83e540b","lhsInputNode":"58485bc8-43f2-30b8-8271-deb42ad81021","rhsInputNode":"ae5c83de-c9f5-3ad0-8715-7eb581e730c7","operator":"CONTAINS"},{"class":"AttributeDefinition","id":"6f3937f5-e9d1-437a-94ff-0a084be7aa7d","name":"Consent Record - EMR-Access.status","resolvers":[{"class":"attribute","attributeDefinitionId":"e311c28a-3cb0-47ba-850f-4905cbfc1c02","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$[0].status"}]}},"properties":{}},{"class":"AttributeNode","id":"3048b83b-901b-3371-9afe-41d27c2670d5","attributeDefinitionId":"6f3937f5-e9d1-437a-94ff-0a084be7aa7d"},{"class":"ConstantNode","id":"3e4d891a-5df3-36d0-97dd-9432a1bc6470","constant":"accepted"},{"class":"ComparisonNode","id":"eca77fe0-d2c9-3e1a-943e-6a5e526b5728","lhsInputNode":"3048b83b-901b-3371-9afe-41d27c2670d5","rhsInputNode":"3e4d891a-5df3-36d0-97dd-9432a1bc6470","operator":"EQUALS"},{"class":"AttributeDefinition","id":"3fca60de-5df8-41ca-951c-1358c8aeb52e","name":"Consent Record - EMR-Access.recordVersion","resolvers":[{"class":"attribute","attributeDefinitionId":"e311c28a-3cb0-47ba-850f-4905cbfc1c02","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$[0].definition.version"}]}},"properties":{}},{"class":"AttributeNode","id":"6eb39ba0-5260-324a-bd4e-7587c53d682d","attributeDefinitionId":"3fca60de-5df8-41ca-951c-1358c8aeb52e"},{"class":"AttributeDefinition","id":"5ccc821f-49af-4dd9-b3e6-3077ee52d21f","name":"Consent Record - EMR-Access.definitionVersion","resolvers":[{"class":"attribute","attributeDefinitionId":"e311c28a-3cb0-47ba-850f-4905cbfc1c02","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$[0].definition.currentVersion"}]}},"properties":{}},{"class":"AttributeNode","id":"c3c19b55-bf0d-376a-bfa7-34d84673d30a","attributeDefinitionId":"5ccc821f-49af-4dd9-b3e6-3077ee52d21f"},{"class":"ComparisonNode","id":"e6454f33-23f0-30c3-a66d-519ad91998da","lhsInputNode":"6eb39ba0-5260-324a-bd4e-7587c53d682d","rhsInputNode":"c3c19b55-bf0d-376a-bfa7-34d84673d30a","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"2275e067-d83e-3dbc-ac78-23373d42e0eb","inputNodes":["4a5b89e0-42b1-322f-b90d-3c32a83e540b","eca77fe0-d2c9-3e1a-943e-6a5e526b5728","e6454f33-23f0-30c3-a66d-519ad91998da"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"6efaf4cc-d651-4509-8315-21ec360c01f2","name":"Patient has granted Implicit access to another User","properties":{},"disabled":false},{"class":"DecisionNode","id":"8cb8172b-d8af-3bcf-9530-3c1b2abf101d","metadataId":"6efaf4cc-d651-4509-8315-21ec360c01f2","effect":"PERMIT","inputNode":"2275e067-d83e-3dbc-ac78-23373d42e0eb"},{"class":"StatementNode","id":"d272c70e-02c1-3b25-b6eb-ef95ae9e800f","inputNode":"8cb8172b-d8af-3bcf-9530-3c1b2abf101d","metadataId":"6efaf4cc-d651-4509-8315-21ec360c01f2","statements":[]},{"class":"TargetMatchNode","id":"83242624-acbe-35ea-b362-07718f2920d8","inputNode":"d272c70e-02c1-3b25-b6eb-ef95ae9e800f","metadataId":"6efaf4cc-d651-4509-8315-21ec360c01f2","targets":[]},{"class":"Metadata","originType":"Policy","originId":"155cbbc6-14e8-49d5-9bef-2c4f3b515f96","name":"Consent Enforcement - Deny unless Permit","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"c33ed0a7-4b6b-36c5-b4da-aabc2eaa405a","combiningAlgorithm":{"name":"DenyUnlessPermit"},"inputNodes":["6d4b6dd0-f69e-3275-802b-abe0daa70103","83242624-acbe-35ea-b362-07718f2920d8"],"inputNodeWeights":[100,100],"guardNode":"6b0617b1-260a-362a-b56a-09d987f60632","originLink":"155cbbc6-14e8-49d5-9bef-2c4f3b515f96"},{"class":"StatementTemplate","id":"30a00eb1-03ce-46a5-9fa8-6df4f7c8b28d","name":"Denied Consent message","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"denied-reason"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"Patient has not consented to this request"}]},"obligatory":false,"appliesTo":"DENY","attributes":{},"services":{}},{"class":"StatementNode","id":"5aeac12e-7b48-3f6f-8eaa-f2408aded8ec","inputNode":"c33ed0a7-4b6b-36c5-b4da-aabc2eaa405a","metadataId":"155cbbc6-14e8-49d5-9bef-2c4f3b515f96","statements":["30a00eb1-03ce-46a5-9fa8-6df4f7c8b28d"]},{"class":"Target","id":"8ec8f50c-6a15-4b5f-82cd-fa928d95bb72","name":"Inline target","domains":[],"services":[],"identityClassIds":[],"actions":["outbound-GET"]},{"class":"TargetMatchNode","id":"158b0727-1d3e-3c58-bc1d-7537d924c9bf","inputNode":"5aeac12e-7b48-3f6f-8eaa-f2408aded8ec","metadataId":"155cbbc6-14e8-49d5-9bef-2c4f3b515f96","targets":["8ec8f50c-6a15-4b5f-82cd-fa928d95bb72"]},{"class":"Metadata","originType":"PolicySet","originId":"c8657381-21ed-438d-a62e-9b3394f2fcf5","name":"FHIR Policies","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"3da5a7af-be36-31fc-8bae-c525e420dbe1","combiningAlgorithm":{"name":"DenyOverrides"},"inputNodes":["64d2e3a6-b1bf-3d0f-a66e-fbec5938f228","158b0727-1d3e-3c58-bc1d-7537d924c9bf"],"inputNodeWeights":[100,100],"guardNode":null,"originLink":"c8657381-21ed-438d-a62e-9b3394f2fcf5"},{"class":"StatementNode","id":"759ca67e-b37e-37cf-9ce4-9efa81358b9e","inputNode":"3da5a7af-be36-31fc-8bae-c525e420dbe1","metadataId":"c8657381-21ed-438d-a62e-9b3394f2fcf5","statements":[]},{"class":"Target","id":"1603dc03-f76a-4c2f-84ee-31e594a02e05","name":"Inline target","domains":[],"services":["EpicFHIR","CernerFHIR"],"identityClassIds":[],"actions":[]},{"class":"TargetMatchNode","id":"78b2221b-833b-3bfe-8c65-f6e2e56c4036","inputNode":"759ca67e-b37e-37cf-9ce4-9efa81358b9e","metadataId":"c8657381-21ed-438d-a62e-9b3394f2fcf5","targets":["1603dc03-f76a-4c2f-84ee-31e594a02e05"]},{"class":"AttributeDefinition","id":"447bf9bf-0cf0-4b62-9b55-58fc9f606f49","name":"HttpRequest.AccessToken.scope","resolvers":[{"class":"attribute","attributeDefinitionId":"8e568465-2e7c-4705-8d94-53102ea8550f","condition":null}],"defaultValue":"[]","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"COLLECTION","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"scope"}]}},"properties":{}},{"class":"AttributeNode","id":"1a687b5a-fa7b-3b3b-924a-6a7f3129e194","attributeDefinitionId":"447bf9bf-0cf0-4b62-9b55-58fc9f606f49"},{"class":"ConstantNode","id":"90d0fe8e-9e89-3323-a244-cc2d53bb34ba","constant":"getCommsOpt"},{"class":"ComparisonNode","id":"92fab737-1407-3f2a-af54-3b570b71e0da","lhsInputNode":"1a687b5a-fa7b-3b3b-924a-6a7f3129e194","rhsInputNode":"90d0fe8e-9e89-3323-a244-cc2d53bb34ba","operator":"CONTAINS"},{"class":"AttributeDefinition","id":"4dd3a38e-39c6-44aa-99d7-106eb4e2b860","name":"HttpRequest.AccessToken.client_id","resolvers":[{"class":"attribute","attributeDefinitionId":"8e568465-2e7c-4705-8d94-53102ea8550f","condition":null}],"defaultValue":"_null","cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"client_id"}]}},"properties":{}},{"class":"AttributeNode","id":"4fcf7e76-2bf2-33bb-b6b7-cd7afb1a688c","attributeDefinitionId":"4dd3a38e-39c6-44aa-99d7-106eb4e2b860"},{"class":"ConstantNode","id":"7cb15e41-6d62-319b-9b40-298324fbe30b","constant":"Marketing"},{"class":"ComparisonNode","id":"ca589c94-133a-33a1-8714-494318b58ca0","lhsInputNode":"4fcf7e76-2bf2-33bb-b6b7-cd7afb1a688c","rhsInputNode":"7cb15e41-6d62-319b-9b40-298324fbe30b","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"ed35a83e-4df4-372e-9bc8-d0613c9ea6fa","inputNodes":["92fab737-1407-3f2a-af54-3b570b71e0da","ca589c94-133a-33a1-8714-494318b58ca0"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"d9053be5-8260-47bb-b6b8-a21a945ba2f0","name":"Check Application and Scope to retrieve data","properties":{},"disabled":false},{"class":"DecisionNode","id":"ef7fb4b9-6bfe-3c03-af84-3277556ca7c1","metadataId":"d9053be5-8260-47bb-b6b8-a21a945ba2f0","effect":"PERMIT","inputNode":"ed35a83e-4df4-372e-9bc8-d0613c9ea6fa"},{"class":"StatementNode","id":"43ba362d-d8c9-3603-99ea-60c6252767be","inputNode":"ef7fb4b9-6bfe-3c03-af84-3277556ca7c1","metadataId":"d9053be5-8260-47bb-b6b8-a21a945ba2f0","statements":[]},{"class":"Target","id":"879f1dc6-9769-4a2b-aeff-aafc2a54d85c","name":"Inline target","domains":[],"services":[],"identityClassIds":[],"actions":["inbound-GET","outbound-GET"]},{"class":"TargetMatchNode","id":"b3d5c331-7867-3c8f-90ae-ce1de7b9e068","inputNode":"43ba362d-d8c9-3603-99ea-60c6252767be","metadataId":"d9053be5-8260-47bb-b6b8-a21a945ba2f0","targets":["879f1dc6-9769-4a2b-aeff-aafc2a54d85c"]},{"class":"Metadata","originType":"Policy","originId":"bcf71dea-cf3e-4d32-a92a-05525bd3f8d5","name":"Communication Options Policy","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"e28aa379-6cc6-3174-8991-0a32bf9a8a56","combiningAlgorithm":{"name":"DenyUnlessPermit"},"inputNodes":["b3d5c331-7867-3c8f-90ae-ce1de7b9e068"],"inputNodeWeights":[100],"guardNode":null,"originLink":"bcf71dea-cf3e-4d32-a92a-05525bd3f8d5"},{"class":"StatementTemplate","id":"df309abd-a1b7-415f-a5b2-f221cc864889","name":"Restrict to just polarityOpt == \"in\"","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"include-attributes"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"[ \"$..fhirCommOpts[?(@.polarityOpt == true)]\" ]"}]},"obligatory":true,"appliesTo":"PERMIT","attributes":{},"services":{}},{"class":"StatementNode","id":"fa59bd0f-8aae-338c-9971-028459d8ac59","inputNode":"e28aa379-6cc6-3174-8991-0a32bf9a8a56","metadataId":"bcf71dea-cf3e-4d32-a92a-05525bd3f8d5","statements":["df309abd-a1b7-415f-a5b2-f221cc864889"]},{"class":"TargetMatchNode","id":"a2a657ee-43ab-3c9b-9706-8dfbf7199fc7","inputNode":"fa59bd0f-8aae-338c-9971-028459d8ac59","metadataId":"bcf71dea-cf3e-4d32-a92a-05525bd3f8d5","targets":[]},{"class":"ConstantNode","id":"07bb51f5-6f86-3630-bd1e-1b0ffe6d3c0a","constant":"getUserProfile"},{"class":"ComparisonNode","id":"a2557392-e59f-362a-be66-f30af0d10625","lhsInputNode":"1a687b5a-fa7b-3b3b-924a-6a7f3129e194","rhsInputNode":"07bb51f5-6f86-3630-bd1e-1b0ffe6d3c0a","operator":"CONTAINS"},{"class":"ConstantNode","id":"6824bf8c-b028-347a-af05-7acc00db55fd","constant":"modifyCommOpts"},{"class":"ComparisonNode","id":"070e1e92-420d-3028-a6b8-2258b1b990c0","lhsInputNode":"1a687b5a-fa7b-3b3b-924a-6a7f3129e194","rhsInputNode":"6824bf8c-b028-347a-af05-7acc00db55fd","operator":"CONTAINS"},{"class":"BooleanLogicNode","id":"45486e0c-ae11-3673-9aa2-c2c6776afcb4","inputNodes":["a2557392-e59f-362a-be66-f30af0d10625","070e1e92-420d-3028-a6b8-2258b1b990c0"],"operator":"or"},{"class":"Metadata","originType":"Rule","originId":"7abef51e-617a-476e-bbc9-57b7fd43a7b5","name":"Check for valid User Profile scopes on Inbound request","properties":{},"disabled":false},{"class":"DecisionNode","id":"82a11f40-4f2d-3a3f-8f30-0a5bd8227740","metadataId":"7abef51e-617a-476e-bbc9-57b7fd43a7b5","effect":"PERMIT","inputNode":"45486e0c-ae11-3673-9aa2-c2c6776afcb4"},{"class":"StatementNode","id":"38fb3786-580b-333f-b014-53e2bc694efb","inputNode":"82a11f40-4f2d-3a3f-8f30-0a5bd8227740","metadataId":"7abef51e-617a-476e-bbc9-57b7fd43a7b5","statements":[]},{"class":"Target","id":"a6d2b4bf-b469-47fe-bb57-d43e1807b9cf","name":"Inline target","domains":[],"services":[],"identityClassIds":[],"actions":["inbound-GET","inbound-PATCH","inbound-POST","inbound-PUT","inbound-DELETE"]},{"class":"TargetMatchNode","id":"7cbf6e9e-ac80-351c-86cc-92e9c87380be","inputNode":"38fb3786-580b-333f-b014-53e2bc694efb","metadataId":"7abef51e-617a-476e-bbc9-57b7fd43a7b5","targets":["a6d2b4bf-b469-47fe-bb57-d43e1807b9cf"]},{"class":"AttributeDefinition","id":"b2c6f3a6-e8d1-4565-9944-10d43d7d7806","name":"UserProfile","resolvers":[{"class":"attribute","attributeDefinitionId":"2139c312-6f7d-49ff-8d00-c48231ed8f19","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{}},{"class":"AttributeDefinition","id":"ce331cfd-8386-48b9-b98e-b668858342e5","name":"UserProfile.entryUUID","resolvers":[{"class":"attribute","attributeDefinitionId":"b2c6f3a6-e8d1-4565-9944-10d43d7d7806","condition":"6b0617b1-260a-362a-b56a-09d987f60632"}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"jsonPath","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$.entryUUID"}]}},"properties":{}},{"class":"AttributeNode","id":"3a9cac6d-2dc4-3249-a095-1afabaa02225","attributeDefinitionId":"ce331cfd-8386-48b9-b98e-b668858342e5"},{"class":"ComparisonNode","id":"462020bc-6184-3200-9100-24fd72e9eb4a","lhsInputNode":"3a9cac6d-2dc4-3249-a095-1afabaa02225","rhsInputNode":"ae5c83de-c9f5-3ad0-8715-7eb581e730c7","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"edcc6698-d08c-3607-af21-90e3d652a6d0","inputNodes":["462020bc-6184-3200-9100-24fd72e9eb4a","a2557392-e59f-362a-be66-f30af0d10625"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"73b82caf-2b8a-42e1-993d-fe8138e81c44","name":"Allow User to see their own profile (limited)","properties":{},"disabled":false},{"class":"DecisionNode","id":"0f998034-e63f-338d-8265-741caba9954c","metadataId":"73b82caf-2b8a-42e1-993d-fe8138e81c44","effect":"PERMIT","inputNode":"edcc6698-d08c-3607-af21-90e3d652a6d0"},{"class":"StatementTemplate","id":"ba9de299-462a-4199-9096-a59eaea7e917","name":"User Accessible attributes","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"include-attributes"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"[ \"fhirCommOpts\", \"fhirRelatedPerson\", \"givenName\", \"sn\", \"fhirName\", \"fhirAddress\", \"fhirIdentifier\" ]"}]},"obligatory":false,"appliesTo":"PERMIT","attributes":{},"services":{}},{"class":"StatementNode","id":"bf1bb55f-590f-3e93-984e-787e66ceb691","inputNode":"0f998034-e63f-338d-8265-741caba9954c","metadataId":"73b82caf-2b8a-42e1-993d-fe8138e81c44","statements":["ba9de299-462a-4199-9096-a59eaea7e917"]},{"class":"Target","id":"039a0588-c35d-4d7d-b797-a3ec6457c952","name":"Inline target","domains":[],"services":[],"identityClassIds":[],"actions":["outbound-GET"]},{"class":"TargetMatchNode","id":"3ad9f86c-a9b5-364d-8e8c-07d09b0987eb","inputNode":"bf1bb55f-590f-3e93-984e-787e66ceb691","metadataId":"73b82caf-2b8a-42e1-993d-fe8138e81c44","targets":["039a0588-c35d-4d7d-b797-a3ec6457c952"]},{"class":"ComparisonNode","id":"60cdf163-358e-3476-8d57-c2308fa83c8e","lhsInputNode":"ae5c83de-c9f5-3ad0-8715-7eb581e730c7","rhsInputNode":"3a9cac6d-2dc4-3249-a095-1afabaa02225","operator":"EQUALS"},{"class":"BooleanLogicNode","id":"39ec30cd-4606-31f3-9b1e-011d29b27a70","inputNodes":["60cdf163-358e-3476-8d57-c2308fa83c8e","070e1e92-420d-3028-a6b8-2258b1b990c0"],"operator":"and"},{"class":"Metadata","originType":"Rule","originId":"53f04875-e3d3-49ef-8ee8-6d657c008469","name":"Allow User to modify their Comms Options","properties":{},"disabled":false},{"class":"DecisionNode","id":"9119d476-b6b7-3262-b33e-f2de720e8bc2","metadataId":"53f04875-e3d3-49ef-8ee8-6d657c008469","effect":"PERMIT","inputNode":"39ec30cd-4606-31f3-9b1e-011d29b27a70"},{"class":"StatementTemplate","id":"891ab3a1-37f1-4eaf-8066-8a6d1730964e","name":"Attributes a User can change","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"include-attributes"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"[ \"fhirCommsOpts\" ]"}]},"obligatory":false,"appliesTo":"PERMIT","attributes":{},"services":{}},{"class":"StatementNode","id":"61ab42b0-258a-32a0-bcb6-b1fc78f0294a","inputNode":"9119d476-b6b7-3262-b33e-f2de720e8bc2","metadataId":"53f04875-e3d3-49ef-8ee8-6d657c008469","statements":["891ab3a1-37f1-4eaf-8066-8a6d1730964e"]},{"class":"Target","id":"3f434c2c-ae7a-4b5a-9ee0-6cce7841b509","name":"Inline target","domains":[],"services":[],"identityClassIds":[],"actions":["inbound-PUT","outbound-PUT"]},{"class":"TargetMatchNode","id":"cd2aab3d-3e03-3bd3-be83-518947105989","inputNode":"61ab42b0-258a-32a0-bcb6-b1fc78f0294a","metadataId":"53f04875-e3d3-49ef-8ee8-6d657c008469","targets":["3f434c2c-ae7a-4b5a-9ee0-6cce7841b509"]},{"class":"Metadata","originType":"Policy","originId":"92115521-87e4-499f-bd97-8cce86260eee","name":"User Profile Policy","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"9cea795f-8bad-3734-be37-69487e874637","combiningAlgorithm":{"name":"DenyUnlessPermit"},"inputNodes":["7cbf6e9e-ac80-351c-86cc-92e9c87380be","3ad9f86c-a9b5-364d-8e8c-07d09b0987eb","cd2aab3d-3e03-3bd3-be83-518947105989"],"inputNodeWeights":[100,100,100],"guardNode":null,"originLink":"92115521-87e4-499f-bd97-8cce86260eee"},{"class":"StatementNode","id":"21d7ef82-0471-3529-916c-b0539aa7e1e8","inputNode":"9cea795f-8bad-3734-be37-69487e874637","metadataId":"92115521-87e4-499f-bd97-8cce86260eee","statements":[]},{"class":"TargetMatchNode","id":"0d262b80-8883-39a0-958a-9ae3070a5d09","inputNode":"21d7ef82-0471-3529-916c-b0539aa7e1e8","metadataId":"92115521-87e4-499f-bd97-8cce86260eee","targets":[]},{"class":"Metadata","originType":"PolicySet","originId":"3f6e3423-2c31-41a0-aa21-cb637638864a","name":"Patient Portal Policies","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"f0743814-c11f-30f7-8694-b68528003117","combiningAlgorithm":{"name":"DenyUnlessPermit"},"inputNodes":["a2a657ee-43ab-3c9b-9706-8dfbf7199fc7","0d262b80-8883-39a0-958a-9ae3070a5d09"],"inputNodeWeights":[100,100],"guardNode":null,"originLink":"3f6e3423-2c31-41a0-aa21-cb637638864a"},{"class":"StatementNode","id":"2ba23862-3108-33ec-8869-56833e2ab0c6","inputNode":"f0743814-c11f-30f7-8694-b68528003117","metadataId":"3f6e3423-2c31-41a0-aa21-cb637638864a","statements":[]},{"class":"Target","id":"4128a281-eb44-4319-a040-72a96a0d4f3e","name":"Inline target","domains":[],"services":["PatientPortal"],"identityClassIds":[],"actions":[]},{"class":"TargetMatchNode","id":"4098d692-0506-3095-b7fa-dac688b04efe","inputNode":"2ba23862-3108-33ec-8869-56833e2ab0c6","metadataId":"3f6e3423-2c31-41a0-aa21-cb637638864a","targets":["4128a281-eb44-4319-a040-72a96a0d4f3e"]},{"class":"Metadata","originType":"PolicySet","originId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","name":"Global Decision Point","properties":{},"disabled":false},{"class":"CombinedDecisionNode","id":"36439d7f-b661-3643-ad0b-bb83fa190d10","combiningAlgorithm":{"name":"DenyOverrides"},"inputNodes":["f4c9d0c8-e1fd-33d0-a163-885e7f5cb7fb","78b2221b-833b-3bfe-8c65-f6e2e56c4036","4098d692-0506-3095-b7fa-dac688b04efe"],"inputNodeWeights":[100,100,100],"guardNode":null,"originLink":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1"},{"class":"StatementNode","id":"b82f2278-ff91-3d51-aae0-7e337b461e0e","inputNode":"36439d7f-b661-3643-ad0b-bb83fa190d10","metadataId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","statements":[]},{"class":"TargetMatchNode","id":"25d69b64-d1e7-36fe-a528-e6a113299586","inputNode":"b82f2278-ff91-3d51-aae0-7e337b461e0e","metadataId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","targets":[]},{"digest":"hTRMdR6SKa7C2hdbqnMOPm7zdom66U/Y6MOsNL+rDoE="}]